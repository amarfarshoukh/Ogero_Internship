/* File content omitted for brevity. Insert full code from chat. */